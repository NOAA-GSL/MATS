<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <style>
        input {
            max-width: 100%;
        }
    </style>
    <script type='text/javascript'> //<![CDATA[
        loc=window.location.href;
        function TCtrl($scope, $http) {
            $scope.domain = ".localhost";
            $scope.ROOT=window.location.href.slice(0,-1);
            $scope.proxy_prefix="";
            $scope.items = {};
            $scope.groups = [];  // used to maintain the order from the applist.json
            $http({method: "GET", url: loc + "environment.json"}).
            // success callback
            success(function (env) {
                $scope.env=env.environment;
                $scope.proxy_prefix=env.proxy_prefix;
            }).
            // error callback
            error(function (data, status, headers, config) {
                $scope.env="unknown";
            });

            $http({method: "GET", url: loc + "applist.json"}).
            // success callback
            success(function (data) {
                for (var di=0; di < data.length;di++) {
                    if ($scope.items[data[di].group] == null) {
                        $scope.items[data[di].group] = [data[di]];
                        $scope.groups.push(data[di].group);
                    } else {
                        ($scope.items[data[di].group]).push(data[di]);
                    }
                }
            }).
            // error callback
            error(function (data, status, headers, config) {
                alert("Could not read application list: /applist.json \n(should be automatically generated)");
            });
        }

        function loadJsCssFile(filename, filetype){
            if (filetype == "js"){ //if filename is a external JavaScript file
                var fileref = document.createElement('script')
                fileref.setAttribute("type","text/javascript")
                fileref.setAttribute("src", filename)
                // load files asynchronously because bootstrap depends on jquery etc.
                fileref.async = false;
            }
            else if (filetype == "css"){ //if filename is an external css file
                var fileref = document.createElement("link")
                fileref.setAttribute("rel", "stylesheet")
                fileref.setAttribute("type", "text/css")
                fileref.setAttribute("href", filename)
                fileref.async = false;
            }
            if (typeof fileref != "undefined"){
                document.getElementsByTagName("head")[0].appendChild(fileref);
            }
        }
        // load the resources dynamically to avoid relative links. The proxies have a tendency to mess up relative links.
        loadJsCssFile(loc + "js/jquery.min.js", "js");
        loadJsCssFile(loc + "font-awesome-4.7.0/css/font-awesome.min.css", "css");
        loadJsCssFile(loc + "css/bootstrap.min.css", "css");
        loadJsCssFile(loc + "js/bootstrap.min.js", "js");
        loadJsCssFile(loc + 'js/angular.min.js', "js");
    </script>
</head>
<body style="background-image: url('img/bg.png')">
<div ng-app ng-controller="TCtrl">
    <div id='main' class="main container-fluid">
        <div id="navbar" style="display:block;height:100%;margin-bottom:0;margin-top:0;padding-top:0;padding-bottom:0;">
            <nav id="topnav" class="navbar navbar-default"
                 style="color:white; background: #006699;height:100%;margin-bottom:0;margin-top:0;padding-top:0;padding-bottom:0;">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                data-target="#navbar-collapse-1" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a style="color:white" class="navbar-brand" href="#">Custom MATS</a>
                        <a style="color:white" class="navbar-brand" href="#"><i style="color:cyan" class="fa fa-home fa-lg" aria-hidden="true"></i></a>

                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a href="http://www.doc.gov/"><span
                                    style="color:white">Organization goes here</span></a></li>
                            <li><a href="http://www.noaa.gov/"><span style="color:white">Administration goes here</span></a>
                            </li>
                            <li><a href="http://www.research.noaa.gov/"><span
                                    style="color:white">Department goes here</span></a>
                            </li>
                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </div>
                <!-- /.container-fluid -->
            </nav>
            <nav id="topnav1" class="navbar navbar-default"
                 style="color:white; background: #000066;height:100%;margin-bottom:0;margin-top:0;padding-top:0;padding-bottom:1.5%;">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                data-target="#navbar-collapse-2" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a style="margin-bottom:0;margin-top:0;padding: 0;" class="navbar-brand" href="#"><img
                                style="height:100%;margin-bottom:0;margin-top:0;padding-left:1em;padding-right:1em;padding-bottom:0;padding-top:0;"
                                src="img/noaa_transparent.gif" alt="NOAA"></a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="navbar-collapse-2">
                        <ul class="nav navbar-nav">
                            <li>
                                <div>
                                    <a href="http://esrl.noaa.gov/"><span style="color:white;font-size: large;">Earth System Research Laboratory</span></a><br>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </div>
                <!-- /.container-fluid -->
            </nav>
            <div style="background-color: #dddddd;height:100%;;margin-bottom:0;margin-top:0;padding-left:1em;padding-right:0" class="container-fluid">
                <ul class="nav navbar-nav navbar-left" style="min-height:10px;">
                    <div>
                        <li ng-repeat="group in groups">
                            <div class="container-fluid">
                                <ul class="nav navbar-nav navbar-left">
                                    <h3>{{group}}:</h3>
                                    <li ng-repeat="item in items[group]">
                                        <h2>Embed URL: {{ROOT}}{{proxy_prefix}}/{{item.app}}</h2>
                                        <a class="btn-sm btn-primary" style="font-size:medium;font-weight: bold; border-radius:10px;"href="{{proxy_prefix}}/{{item.app}}">{{item.title}}</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </div>
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- ng-app -->
</body>
</html>


