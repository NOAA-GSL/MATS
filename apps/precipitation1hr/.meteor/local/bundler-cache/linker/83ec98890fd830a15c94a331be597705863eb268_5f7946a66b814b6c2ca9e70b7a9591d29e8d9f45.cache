[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\n\n/* Package-scope variables */\nvar Hooks, EventHooksMonitoringCollection;\n\n(function(){\n\n///////////////////////////////////////////////////////////////////////\n//                                                                   //\n// packages/differential_event-hooks/packages/differential_event-hoo //\n//                                                                   //\n///////////////////////////////////////////////////////////////////////\n                                                                     //\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                    //\n// packages/differential:event-hooks/client.js                                                                        //\n//                                                                                                                    //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                      //\n//////////////////////////////////                                                                                    // 1\n//= SETUP HOOKS OBJECT                                                                                                // 2\n//////////////////////////////////                                                                                    // 3\n                                                                                                                      // 4\nHooks = {                                                                                                             // 5\n\t//////////////////////////////////                                                                                   // 6\n\t//= OPTIONS                                                                                                          // 7\n\t//////////////////////////////////                                                                                   // 8\n                                                                                                                      // 9\n\tupdateFocus: 0, // Number of milliseconds to wait before checking whether the window is focused                      // 10\n\ttreatCloseAsLogout: false,                                                                                           // 11\n                                                                                                                      // 12\n                                                                                                                      // 13\n\t//////////////////////////////////                                                                                   // 14\n\t//= INTERNAL STATES                                                                                                  // 15\n\t//////////////////////////////////                                                                                   // 16\n                                                                                                                      // 17\n\tfocused: true,                                                                                                       // 18\n\tloggedIn: false,                                                                                                     // 19\n\tlastUserId: null,                                                                                                    // 20\n                                                                                                                      // 21\n                                                                                                                      // 22\n\t//////////////////////////////////                                                                                   // 23\n\t//= METHODS                                                                                                          // 24\n\t//////////////////////////////////                                                                                   // 25\n\tcheckFocus: function () {                                                                                            // 26\n\t\t// Check if the window is currently focused                                                                         // 27\n\t\tif (document.hasFocus() && Hooks.focused === false) {                                                               // 28\n\t\t\t// We've gained focus                                                                                              // 29\n\t\t\tHooks.focused = true;                                                                                              // 30\n\t\t\tif (typeof Hooks.onGainFocus !== undefined) Hooks.onGainFocus(); // Fire the event on the client                   // 31\n\t\t\tMeteor.call('eventsOnGainFocus'); // Fire the event on the server                                                  // 32\n\t\t} else if (! document.hasFocus() && Hooks.focused === true) {                                                       // 33\n\t\t\t// We've lost focus                                                                                                // 34\n\t\t\tHooks.focused = false;                                                                                             // 35\n\t\t\tif (typeof Hooks.onLoseFocus !== undefined) Hooks.onLoseFocus(); // Fire the event on the client                   // 36\n\t\t\tMeteor.call('eventsOnLoseFocus'); // Fire the event on the server                                                  // 37\n\t\t}                                                                                                                   // 38\n\t},                                                                                                                   // 39\n\tinit: function (options) {                                                                                           // 40\n\t\t//////////////////////////////////                                                                                  // 41\n\t\t//= BASIC INITIALIZATION                                                                                            // 42\n\t\t//////////////////////////////////                                                                                  // 43\n                                                                                                                      // 44\n\t\t// Initialize options                                                                                               // 45\n\t\tif (typeof options !== 'undefined') {                                                                               // 46\n\t\t\tif (options.updateFocus) Hooks.updateFocus = options.updateFocus;                                                  // 47\n\t\t\tif (options.treatCloseAsLogout) Hooks.treatCloseAsLogout = options.treatCloseAsLogout;                             // 48\n\t\t}                                                                                                                   // 49\n                                                                                                                      // 50\n                                                                                                                      // 51\n\t\t//////////////////////////////////                                                                                  // 52\n\t\t//= INITIALIZE CLIENT EVENTS                                                                                        // 53\n\t\t//////////////////////////////////                                                                                  // 54\n                                                                                                                      // 55\n\t\t// Start checking for focus if a truthy integer is given                                                            // 56\n\t\tif (Hooks.updateFocus != false) {                                                                                   // 57\n\t\t\tMeteor.setInterval(Hooks.checkFocus, Hooks.updateFocus);                                                           // 58\n\t\t}                                                                                                                   // 59\n                                                                                                                      // 60\n\t\t// Close window/tab                                                                                                 // 61\n\t\twindow.onbeforeunload = function() {                                                                                // 62\n\t\t\tMeteor.call('eventsOnCloseSession'); // Fire the event on the server                                               // 63\n                                                                                                                      // 64\n\t\t\t// If we're treating close as logout, fire the logout event as well                                                // 65\n\t\t\tif (Hooks.treatCloseAsLogout === true) {                                                                           // 66\n\t\t\t\tMeteor.call('eventsOnLoggedOut', Hooks.lastUserId); // Fire the event on the server                               // 67\n\t\t\t}                                                                                                                  // 68\n\t\t}                                                                                                                   // 69\n                                                                                                                      // 70\n                                                                                                                      // 71\n                                                                                                                      // 72\n\t\t//////////////////////////////////                                                                                  // 73\n\t\t//= SETUP LOGIN MONITORING                                                                                          // 74\n\t\t//////////////////////////////////                                                                                  // 75\n                                                                                                                      // 76\n\t\tDeps.autorun(function () {                                                                                          // 77\n\t\t\tif (Meteor.userId()) {                                                                                             // 78\n\t\t\t\t// User is logged in                                                                                              // 79\n\t\t\t\tif (Hooks.loggedIn === false) {                                                                                   // 80\n\t\t\t\t\t// Update the latest user id                                                                                     // 81\n\t\t\t\t\tHooks.lastUserId = Meteor.userId();                                                                              // 82\n\t\t\t\t\t// User wasn't logged in before this updated, so fire the loggedIn event                                         // 83\n\t\t\t\t\tif (typeof Hooks.onLoggedIn !== undefined) Hooks.onLoggedIn(); // Fire the event on the client                   // 84\n\t\t\t\t\tMeteor.call('eventsOnLoggedIn'); // Fire the event on the server                                                 // 85\n\t\t\t\t}                                                                                                                 // 86\n                                                                                                                      // 87\n\t\t\t\tHooks.loggedIn = true; // Now set the proper state                                                                // 88\n\t\t\t} else {                                                                                                           // 89\n\t\t\t\t// There is no user logged in right now                                                                           // 90\n\t\t\t\tif (Hooks.loggedIn === true) {                                                                                    // 91\n\t\t\t\t\t// User was logged in before this updated, so fire the loggedOut event                                           // 92\n\t\t\t\t\tif (typeof Hooks.onLoggedOut !== undefined) Hooks.onLoggedOut(Hooks.lastUserId); // Fire the event on the client // 93\n\t\t\t\t\tMeteor.call('eventsOnLoggedOut', Hooks.lastUserId); // Fire the event on the server                              // 94\n\t\t\t\t}                                                                                                                 // 95\n                                                                                                                      // 96\n\t\t\t\tHooks.loggedIn = false; // Now set the proper state                                                               // 97\n\t\t\t}                                                                                                                  // 98\n\t\t});                                                                                                                 // 99\n\t},                                                                                                                   // 100\n                                                                                                                      // 101\n\t//////////////////////////////////                                                                                   // 102\n\t//= DEFINE API METHODS                                                                                               // 103\n\t//////////////////////////////////                                                                                   // 104\n\tonLoseFocus:    function(){},                                                                                        // 105\n\tonGainFocus:    function(){},                                                                                        // 106\n\tonCloseSession: function(){},                                                                                        // 107\n\tonLoggedIn:     function(){},                                                                                        // 108\n\tonLoggedOut:    function(){}                                                                                         // 109\n};                                                                                                                    // 110\n                                                                                                                      // 111\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                    //\n// packages/differential:event-hooks/common.js                                                                        //\n//                                                                                                                    //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                      //\n// We define this collection as a hack-ish way of                                                                     // 1\n// triggering updates on the client from the server                                                                   // 2\nEventHooksMonitoringCollection = new Meteor.Collection('eventHooksMonitoringCollection');                             // 3\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n///////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"differential:event-hooks\", {\n  Hooks: Hooks,\n  EventHooksMonitoringCollection: EventHooksMonitoringCollection\n});\n\n})();\n","servePath":"/packages/differential_event-hooks.js"}]