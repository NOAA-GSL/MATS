[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\n\n/* Package-scope variables */\nvar Hooks, EventHooksMonitoringCollection;\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                              //\n// packages/differential_event-hooks/packages/differential_event-hooks.js                       //\n//                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                //\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                        //\n// packages/differential:event-hooks/server.js                                            //\n//                                                                                        //\n////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                          //\n//////////////////////////////////                                                        // 1\n//= SETUP HOOKS OBJECT                                                                    // 2\n//////////////////////////////////                                                        // 3\n                                                                                          // 4\nHooks = {                                                                                 // 5\n    onLoseFocus:    function(){},                                                         // 6\n    onGainFocus:    function(){},                                                         // 7\n    onCloseSession: function(){},                                                         // 8\n    onLoggedIn:     function(){},                                                         // 9\n    onLoggedOut:    function(){},                                                         // 10\n    onCreateUser:   function(){},                                                         // 11\n    onDeleteUser:   function(){}                                                          // 12\n};                                                                                        // 13\n                                                                                          // 14\n                                                                                          // 15\n//////////////////////////////////                                                        // 16\n//= SETUP METEOR METHODS                                                                  // 17\n//////////////////////////////////                                                        // 18\n                                                                                          // 19\nMeteor.methods({                                                                          // 20\n    eventsOnLoseFocus: function () {                                                      // 21\n        // Fire the loseFocus event                                                       // 22\n        Hooks.onLoseFocus(this.userId);                                                   // 23\n    },                                                                                    // 24\n    eventsOnGainFocus: function () {                                                      // 25\n        // Fire the gainFocus event                                                       // 26\n        Hooks.onGainFocus(this.userId);                                                   // 27\n    },                                                                                    // 28\n    eventsOnCloseSession: function () {                                                   // 29\n        // Fire the closeSession event                                                    // 30\n        Hooks.onCloseSession(this.userId);                                                // 31\n    },                                                                                    // 32\n    eventsOnLoggedIn: function () {                                                       // 33\n        // Fire the loggedIn event                                                        // 34\n        Hooks.onLoggedIn(this.userId);                                                    // 35\n    },                                                                                    // 36\n    eventsOnLoggedOut: function (userId) {                                                // 37\n        // Fire the loggedOut event                                                       // 38\n        Hooks.onLoggedOut(userId);                                                        // 39\n    }                                                                                     // 40\n});                                                                                       // 41\n                                                                                          // 42\n                                                                                          // 43\n//////////////////////////////////                                                        // 44\n//= SETUP USER MONITORING                                                                 // 45\n//////////////////////////////////                                                        // 46\n                                                                                          // 47\nvar currentUsers = Meteor.users.find().count();                                           // 48\nvar userCount;                                                                            // 49\n                                                                                          // 50\n// Begin monitoring users                                                                 // 51\nMeteor.users.find({}, { limit: 1, sort: { createdAt: -1 } }).observeChanges({             // 52\n    added: function (id, fields) {                                                        // 53\n        userCount = Meteor.users.find().count();                                          // 54\n                                                                                          // 55\n        if (userCount > currentUsers) {                                                   // 56\n            currentUsers = userCount;                                                     // 57\n            Hooks.onCreateUser(id); // Fire the event on the server                       // 58\n        }                                                                                 // 59\n    }                                                                                     // 60\n});                                                                                       // 61\n                                                                                          // 62\nMeteor.users.find().observeChanges({                                                      // 63\n    removed: function (id) {                                                              // 64\n        currentUsers = Meteor.users.find().count();                                       // 65\n        Hooks.onDeleteUser(id); // Fire the event on the server                           // 66\n    }                                                                                     // 67\n});                                                                                       // 68\n                                                                                          // 69\n////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                        //\n// packages/differential:event-hooks/common.js                                            //\n//                                                                                        //\n////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                          //\n// We define this collection as a hack-ish way of                                         // 1\n// triggering updates on the client from the server                                       // 2\nEventHooksMonitoringCollection = new Meteor.Collection('eventHooksMonitoringCollection'); // 3\n////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n//////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"differential:event-hooks\", {\n  Hooks: Hooks,\n  EventHooksMonitoringCollection: EventHooksMonitoringCollection\n});\n\n})();\n","servePath":"/packages/differential_event-hooks.js"}]