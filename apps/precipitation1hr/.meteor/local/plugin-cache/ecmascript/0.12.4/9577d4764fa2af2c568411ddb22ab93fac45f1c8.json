{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/databases.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"packages/randyp:mats-common/templates/administration/databases.js","filename":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/databases.js","passPerPreset":false,"envName":"development","cwd":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr","root":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr","plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/databases.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/randyp:mats-common/templates/administration/databases.js"}},"code":"let matsCollections;\nmodule.link(\"meteor/randyp:mats-common\", {\n  matsCollections(v) {\n    matsCollections = v;\n  }\n\n}, 0);\nlet matsMethods;\nmodule.link(\"meteor/randyp:mats-common\", {\n  matsMethods(v) {\n    matsMethods = v;\n  }\n\n}, 1);\nTemplate.databases.onRendered(function () {\n  reset();\n});\nTemplate.databases.helpers({\n  databases: function () {\n    dbs = matsCollections.Databases.find({}).fetch();\n    dbs.unshift({\n      name: \"New Database\"\n    });\n    return dbs;\n  },\n  errorMessage: function () {\n    return Session.get(\"databaseErrorMessage\");\n  },\n  errorTypeIs: function (type) {\n    return Session.get(\"databaseErrorType\") === type;\n  }\n});\n\nvar reset = function () {\n  document.getElementById(\"database-selection\").value = \"\";\n  document.getElementById(\"database-name\").value = \"\";\n  document.getElementById(\"database-role-model\").checked = false;\n  document.getElementById(\"database-role-ua\").checked = false;\n  document.getElementById(\"database-status-standby\").checked = false;\n  document.getElementById(\"database-status-active\").checked = false;\n  document.getElementById(\"database-host\").value = \"\";\n  document.getElementById(\"database-database\").value = \"\";\n  document.getElementById(\"database-user\").value = \"\";\n  document.getElementById(\"database-password\").value = \"\";\n  document.getElementById(\"database-verify\").value = \"\";\n  resetError();\n};\n\nvar resetError = function () {\n  errorMessage = \"\";\n  Session.set(\"databaseErrorMessage\", \"\");\n  Session.set(\"databaseErrorType\", \"\");\n\n  if (document.getElementById(\"errorMessage\")) {\n    document.getElementById(\"errorMessage\").style.display = \"none\";\n  }\n};\n\nvar setError = function (type, message) {\n  Session.set(\"databaseErrorMessage\", message);\n  Session.set(\"databaseErrorType\", type);\n  document.getElementById(\"errorMessage\").style.display = \"block\";\n};\n\nTemplate.databases.events({\n  'click .database': function () {\n    resetError();\n    var dbName = document.getElementById(\"database-selection\").value;\n\n    if (dbName == \"New Database\") {\n      reset();\n      return false;\n    }\n\n    var db = matsCollections.Databases.findOne({\n      name: dbName\n    });\n    document.getElementById(\"database-selection\").value = \"\";\n    document.getElementById(\"database-name\").value = db.name;\n    document.getElementById(\"database-role-model\").checked = db.role == \"model\";\n    document.getElementById(\"database-role-ua\").checked = db.role == \"ua\";\n    document.getElementById(\"database-status-standby\").checked = db.status == \"standby\";\n    document.getElementById(\"database-status-active\").checked = db.status == \"active\";\n    document.getElementById(\"database-host\").value = db.host;\n    document.getElementById(\"database-database\").value = db.database;\n    document.getElementById(\"database-user\").value = db.user;\n    document.getElementById(\"database-password\").value = db.password;\n    document.getElementById(\"database-verify\").value = db.password;\n  },\n  'click .apply-database': function () {\n    var settings = {};\n    resetError();\n    settings.name = document.getElementById(\"database-name\").value;\n\n    if (document.getElementById(\"database-role-model\").checked === true) {\n      settings.role = \"model\";\n    } else if (document.getElementById(\"database-role-ua\").checked === true) {\n      settings.role = \"ua\";\n    }\n\n    if (document.getElementById(\"database-status-standby\").checked === true) {\n      settings.status = \"standby\";\n    } else if (document.getElementById(\"database-status-active\").checked === true) {\n      // set any other database with this role to standby\n      matsCollections.Databases.upsert({});\n      settings.status = \"active\";\n    }\n\n    settings.host = document.getElementById(\"database-host\").value;\n    settings.database = document.getElementById(\"database-database\").value;\n    settings.user = document.getElementById(\"database-user\").value;\n    settings.password = document.getElementById(\"database-password\").value;\n    var verify = document.getElementById(\"database-verify\").value;\n\n    if (settings.password != verify) {\n      setError('password', \"Password and Verify do not match!\");\n      return false;\n    }\n\n    if (settings.name === \"\") {\n      setError(\"name\", \"you have to set a name\");\n      return false;\n    } // ONLY ONE CAN BE ACTIVE FOR A GIVEN ROLE\n    //if (settings.role === \"\") {\n    //    setError(role,\"you have to set a role\");\n    //    return false;\n    //}\n\n\n    if (settings.host === \"\") {\n      setError('host', \"you have to set a host\");\n      return false;\n    }\n\n    if (settings.database === \"\") {\n      setError('database', \"you have to set a database\");\n      return false;\n    }\n\n    if (settings.user === \"\") {\n      setError('user', \"you have to set a user\");\n      return false;\n    }\n\n    matsMethods.applyDatabaseSettings.call(settings, function (error) {\n      if (error) {\n        setError(new error('matsMethods.applyDatabaseSettings from Template.databases.events: 121 error:' + error.message));\n        return false;\n      }\n    });\n    reset();\n    $(\"#databasesModal\").modal('hide');\n    return false;\n  },\n  'click .remove-database': function () {\n    var dbName = document.getElementById(\"database-name\").value;\n    matsMethods.removeDatabase.call(dbName, function (error) {\n      if (error) {\n        setError(new Error('matsMethods.removeDatabase from Template.databases.events: 121 error:' + error.message));\n      }\n    });\n    reset();\n    $(\"#databasesModal\").modal('hide');\n    return false;\n  },\n  'click .cancel-database': function () {\n    reset();\n  }\n});","map":{"version":3,"sources":["packages/randyp:mats-common/templates/administration/databases.js"],"names":["matsCollections","module","link","v","matsMethods","Template","databases","onRendered","reset","helpers","dbs","Databases","find","fetch","unshift","name","errorMessage","Session","get","errorTypeIs","type","document","getElementById","value","checked","resetError","set","style","display","setError","message","events","dbName","db","findOne","role","status","host","database","user","password","settings","upsert","verify","applyDatabaseSettings","call","error","$","modal","removeDatabase","Error"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2019 Colorado State University and Regents of the University of Colorado. All rights reserved.\n */\n\nimport {matsCollections} from 'meteor/randyp:mats-common';\nimport { matsMethods } from 'meteor/randyp:mats-common';\n\nTemplate.databases.onRendered(function () {\n    reset();\n});\nTemplate.databases.helpers({\n    databases : function() {\n        dbs = matsCollections.Databases.find({}).fetch();\n        dbs.unshift({name:\"New Database\"});\n        return dbs;\n    },\n    errorMessage: function() {\n        return Session.get(\"databaseErrorMessage\");\n    },\n    errorTypeIs: function(type) {\n        return Session.get(\"databaseErrorType\") === type;\n    }\n\n\n});\nvar reset = function(){\n    document.getElementById(\"database-selection\").value = \"\";\n    document.getElementById(\"database-name\").value = \"\";\n    document.getElementById(\"database-role-model\").checked = false;\n    document.getElementById(\"database-role-ua\").checked = false;\n    document.getElementById(\"database-status-standby\").checked = false;\n    document.getElementById(\"database-status-active\").checked = false;\n    document.getElementById(\"database-host\").value = \"\";\n    document.getElementById(\"database-database\").value = \"\";\n    document.getElementById(\"database-user\").value = \"\";\n    document.getElementById(\"database-password\").value = \"\";\n    document.getElementById(\"database-verify\").value = \"\";\n    resetError();\n};\nvar resetError = function() {\n    errorMessage = \"\";\n    Session.set(\"databaseErrorMessage\",\"\");\n    Session.set(\"databaseErrorType\",\"\");\n    if (document.getElementById(\"errorMessage\")) {\n        document.getElementById(\"errorMessage\").style.display = \"none\";\n    }\n};\nvar setError = function(type,message) {\n    Session.set(\"databaseErrorMessage\", message);\n    Session.set(\"databaseErrorType\", type);\n\n    document.getElementById(\"errorMessage\").style.display = \"block\";\n};\n\nTemplate.databases.events({\n    'click .database': function() {\n        resetError();\n        var dbName = document.getElementById(\"database-selection\").value;\n        if (dbName == \"New Database\") {\n            reset();\n            return false;\n        }\n        var db = matsCollections.Databases.findOne({name:dbName});\n        document.getElementById(\"database-selection\").value = \"\";\n        document.getElementById(\"database-name\").value = db.name;\n        document.getElementById(\"database-role-model\").checked = db.role == \"model\";\n        document.getElementById(\"database-role-ua\").checked = db.role == \"ua\";\n        document.getElementById(\"database-status-standby\").checked = db.status == \"standby\";\n        document.getElementById(\"database-status-active\").checked = db.status == \"active\";\n        document.getElementById(\"database-host\").value = db.host;\n        document.getElementById(\"database-database\").value = db.database;\n        document.getElementById(\"database-user\").value = db.user;\n        document.getElementById(\"database-password\").value = db.password;\n        document.getElementById(\"database-verify\").value = db.password;\n    },\n    'click .apply-database': function () {\n        var settings = {};\n        resetError();\n        settings.name = document.getElementById(\"database-name\").value;\n        if (document.getElementById(\"database-role-model\").checked === true) {\n            settings.role = \"model\";\n        } else if (document.getElementById(\"database-role-ua\").checked === true) {\n            settings.role = \"ua\";\n        }\n        if (document.getElementById(\"database-status-standby\").checked === true) {\n            settings.status = \"standby\";\n        } else if (document.getElementById(\"database-status-active\").checked === true) {\n            // set any other database with this role to standby\n            matsCollections.Databases.upsert({});\n            settings.status = \"active\";\n        }\n        settings.host = document.getElementById(\"database-host\").value;\n        settings.database = document.getElementById(\"database-database\").value;\n        settings.user = document.getElementById(\"database-user\").value;\n        settings.password = document.getElementById(\"database-password\").value;\n        var verify = document.getElementById(\"database-verify\").value;\n        if (settings.password != verify) {\n            setError('password',\"Password and Verify do not match!\");\n            return false;\n        }\n        if (settings.name === \"\") {\n            setError(\"name\",\"you have to set a name\");\n            return false;\n        }\n        // ONLY ONE CAN BE ACTIVE FOR A GIVEN ROLE\n        //if (settings.role === \"\") {\n        //    setError(role,\"you have to set a role\");\n        //    return false;\n        //}\n        if (settings.host === \"\"){\n            setError('host',\"you have to set a host\");\n            return false;\n        }\n        if (settings.database === \"\"){\n            setError('database',\"you have to set a database\");\n            return false;\n        }\n        if (settings.user === \"\"){\n            setError('user',\"you have to set a user\");\n            return false;\n        }\n\n        matsMethods.applyDatabaseSettings.call( settings, function (error) {\n            if (error) {\n                setError(new error('matsMethods.applyDatabaseSettings from Template.databases.events: 121 error:' + error.message));\n                return false;\n            }\n        });\n        reset();\n        $(\"#databasesModal\").modal('hide');\n        return false;\n    },\n    'click .remove-database': function() {\n        var dbName = document.getElementById(\"database-name\").value;\n        matsMethods.removeDatabase.call( dbName, function (error) {\n            if (error) {\n                setError(new Error('matsMethods.removeDatabase from Template.databases.events: 121 error:' + error.message));\n            }\n        });\n        reset();\n        $(\"#databasesModal\").modal('hide');\n        return false;\n    },\n    'click .cancel-database': function() {\n        reset();\n    }\n});\n\n\n"]},"sourceType":"script","hash":"9577d4764fa2af2c568411ddb22ab93fac45f1c8"}
