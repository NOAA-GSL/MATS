{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/export.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser.legacy"},"sourceFileName":"packages/randyp:mats-common/templates/administration/export.js","filename":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/export.js","passPerPreset":false,"envName":"development","cwd":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr","root":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr","plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"proposal-class-properties","visitor":{"PrivateName":{"enter":[null]},"_exploded":true,"_verified":true,"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"transform-react-jsx","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"transform-react-display-name","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/Users/jeffrey.a.hamilton/WebstormProjects/MATS_for_EMB/apps/precipitation1hr/packages/randyp:mats-common/templates/administration/export.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"packages/randyp:mats-common/templates/administration/export.js"}},"code":"var matsCollections;\nmodule.link(\"meteor/randyp:mats-common\", {\n  matsCollections: function (v) {\n    matsCollections = v;\n  }\n}, 0);\nvar matsMethods;\nmodule.link(\"meteor/randyp:mats-common\", {\n  matsMethods: function (v) {\n    matsMethods = v;\n  }\n}, 1);\nTemplate.export.onRendered(function () {\n  matsMethods.getDataFunctionFileList.call(function (error, result) {\n    //    //console.log ('result is : ' + JSON.stringify(result, null, '\\t'));\n    if (error !== undefined) {\n      setError(new Error(\"matsMethods.getDataFunctionFileList from template export error: \" + error.toLocaleString()));\n      return false;\n    }\n\n    Session.set('dataFunctionFileList', result);\n  });\n  matsMethods.getGraphFunctionFileList.call(function (error, result) {\n    //    //console.log ('result is : ' + JSON.stringify(result, null, '\\t'));\n    if (error !== undefined) {\n      setError(new Error())(\"matsMethods.graphFunctionFileList from export.js error: \" + error.toLocaleString());\n      return false;\n    }\n\n    Session.set('graphFunctionFileList', result);\n  });\n});\nTemplate.export.helpers({\n  dataFiles: function () {\n    return Session.get('dataFunctionFileList');\n  },\n  graphFiles: function () {\n    return Session.get('graphFunctionFileList');\n  }\n});\nTemplate.export.events({\n  'click .apply_export': function (event) {\n    event.preventDefault();\n    var parameterOut = document.getElementById('parameterFile').checked;\n    var dataFiles = [];\n    var graphFiles = [];\n    $(\"input:checkbox[name=dataFiles]:checked\").each(function () {\n      dataFiles.push($(this).val());\n    });\n    $(\"input:checkbox[name=graphFiles]:checked\").each(function () {\n      graphFiles.push($(this).val());\n    });\n\n    if (parameterOut) {\n      var data = {};\n      data.CurveParams = matsCollections.CurveParams.find({}).fetch();\n      data.PlotParams = matsCollections.PlotParams.find({}).fetch();\n      data.PlotGraphFunctions = matsCollections.PlotGraphFunctions.find({}).fetch();\n      data.Settings = matsCollections.Settings.find({}).fetch();\n      data.ColorScheme = matsCollections.ColorScheme.find({}).fetch();\n      data.Authorization = matsCollections.Authorization.find({}).fetch();\n      data.Roles = matsCollections.Roles.find({}).fetch();\n      data.Databases = matsCollections.Databases.find({}).fetch();\n      data.Credentials = matsCollections.Credentials.find({}).fetch();\n      var json = JSON.stringify(data, null, 2);\n      var blob = new Blob([json], {\n        type: \"application/json\"\n      });\n      var url = URL.createObjectURL(blob);\n      var a = document.createElement('a');\n      a.download = \"export.json\";\n      a.href = url;\n      a.target = '_blank';\n      a.textContent = \"export.json\";\n      document.body.appendChild(a);\n      a.click();\n    }\n\n    if (dataFiles.length > 0) {\n      dataFiles.forEach(function (file) {\n        matsMethods.readFunctionFile('data', file, function (error, result) {\n          if (error !== undefined) {\n            setError(new Error(error.toLocaleString()));\n            return false;\n          }\n\n          data = result;\n          var blob = new Blob([result], {\n            type: \"application/javascript\"\n          });\n          var url = URL.createObjectURL(blob);\n          var a = document.createElement('a');\n          a.download = file;\n          a.href = url;\n          a.target = '_blank';\n          a.textContent = file;\n          document.body.appendChild(a);\n          a.click();\n        });\n      });\n    }\n\n    if (graphFiles.length > 0) {\n      graphFiles.forEach(function (file) {\n        matsMethods.readFunctionFile('graph', file, function (error, result) {\n          if (error !== undefined) {\n            setError(new Error(error.toLocaleString()));\n            return false;\n          }\n\n          data = result;\n          var blob = new Blob([result], {\n            type: \"application/javascript\"\n          });\n          var url = URL.createObjectURL(blob);\n          var a = document.createElement('a');\n          a.download = file;\n          a.href = url;\n          a.target = '_blank';\n          a.textContent = file;\n          document.body.appendChild(a);\n          a.click();\n        });\n      });\n    }\n\n    $(\"#exportModal\").modal('hide');\n    return false;\n  }\n});","map":{"version":3,"sources":["packages/randyp:mats-common/templates/administration/export.js"],"names":["matsCollections","module","link","v","matsMethods","Template","export","onRendered","getDataFunctionFileList","call","error","result","undefined","setError","Error","toLocaleString","Session","set","getGraphFunctionFileList","helpers","dataFiles","get","graphFiles","events","event","preventDefault","parameterOut","document","getElementById","checked","$","each","push","val","data","CurveParams","find","fetch","PlotParams","PlotGraphFunctions","Settings","ColorScheme","Authorization","Roles","Databases","Credentials","json","JSON","stringify","blob","Blob","type","url","URL","createObjectURL","a","createElement","download","href","target","textContent","body","appendChild","click","length","forEach","file","readFunctionFile","modal"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2019 Colorado State University and Regents of the University of Colorado. All rights reserved.\n */\n\nimport {matsCollections} from 'meteor/randyp:mats-common';\nimport {matsMethods} from 'meteor/randyp:mats-common';\n\n\nTemplate.export.onRendered( function() {\n       matsMethods.getDataFunctionFileList.call( function (error, result) {\n           //    //console.log ('result is : ' + JSON.stringify(result, null, '\\t'));\n           if (error !== undefined) {\n               setError(new Error(\"matsMethods.getDataFunctionFileList from template export error: \" + error.toLocaleString()));\n               return false;\n           }\n           Session.set('dataFunctionFileList',result);\n       });\n       matsMethods.getGraphFunctionFileList.call(function (error, result) {\n           //    //console.log ('result is : ' + JSON.stringify(result, null, '\\t'));\n           if (error !== undefined) {\n               setError(new Error)(\"matsMethods.graphFunctionFileList from export.js error: \" + error.toLocaleString());\n               return false;\n           }\n           Session.set('graphFunctionFileList',result);\n       });\n\n    });\n\n    Template.export.helpers({\n        dataFiles: function() {\n            return Session.get('dataFunctionFileList');\n        },\n        graphFiles: function() {\n            return Session.get('graphFunctionFileList');\n        }\n    });\n\n    Template.export.events({\n    'click .apply_export': function (event) {\n        event.preventDefault();\n        var parameterOut = document.getElementById('parameterFile').checked;\n        var dataFiles = [];\n        var graphFiles = [];\n        $(\"input:checkbox[name=dataFiles]:checked\").each(function(){\n            dataFiles.push($(this).val());\n        });\n        $(\"input:checkbox[name=graphFiles]:checked\").each(function(){\n            graphFiles.push($(this).val());\n        });\n        if(parameterOut) {\n            var data = {};\n            data.CurveParams = matsCollections.CurveParams.find({}).fetch();\n            data.PlotParams = matsCollections.PlotParams.find({}).fetch();\n            data.PlotGraphFunctions = matsCollections.PlotGraphFunctions.find({}).fetch();\n            data.Settings = matsCollections.Settings.find({}).fetch();\n            data.ColorScheme = matsCollections.ColorScheme.find({}).fetch();\n            data.Authorization = matsCollections.Authorization.find({}).fetch();\n            data.Roles = matsCollections.Roles.find({}).fetch();\n            data.Databases = matsCollections.Databases.find({}).fetch();\n            data.Credentials = matsCollections.Credentials.find({}).fetch();\n            var json = JSON.stringify(data, null, 2);\n            var blob = new Blob([json], {type: \"application/json\"});\n            var url = URL.createObjectURL(blob);\n            var a = document.createElement('a');\n            a.download = \"export.json\";\n            a.href = url;\n            a.target = '_blank';\n            a.textContent = \"export.json\";\n            document.body.appendChild(a);\n            a.click();\n        }\n\n        if (dataFiles.length > 0) {\n            dataFiles.forEach(function(file){\n                matsMethods.readFunctionFile('data',file, function (error, result) {\n                    if (error !== undefined) {\n                        setError(new Error(error.toLocaleString()));\n                        return false;\n                    }\n                    data = result;\n                    var blob = new Blob([result], {type: \"application/javascript\"});\n                    var url = URL.createObjectURL(blob);\n                    var a = document.createElement('a');\n                    a.download = file;\n                    a.href = url;\n                    a.target = '_blank';\n                    a.textContent = file;\n                    document.body.appendChild(a);\n                    a.click();\n                });\n            });\n        }\n\n        if (graphFiles.length > 0) {\n            graphFiles.forEach(function(file){\n                matsMethods.readFunctionFile('graph', file, function (error, result) {\n                    if (error !== undefined) {\n                        setError(new Error(error.toLocaleString()));\n                        return false;\n                    }\n                    data = result;\n                    var blob = new Blob([result], {type: \"application/javascript\"});\n                    var url = URL.createObjectURL(blob);\n                    var a = document.createElement('a');\n                    a.download = file;\n                    a.href = url;\n                    a.target = '_blank';\n                    a.textContent = file;\n                    document.body.appendChild(a);\n                    a.click();\n                });\n            });\n        }\n\n        $(\"#exportModal\").modal('hide');\n        return false;\n    }\n});\n\n"]},"sourceType":"script","hash":"03fb77e395e22383488d177d13dd3382334ec0ba"}
